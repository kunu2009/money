<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7K Money - API Key Tester</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        input, button {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-size: 16px;
        }
        button {
            background: #2A9D8F;
            color: white;
            cursor: pointer;
            border: none;
        }
        button:hover {
            background: #238177;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß 7K Money API Key Tester</h1>
        <p>Test your Gemini API key to ensure it works with the 7K Money app.</p>
        
        <input type="password" id="apiKey" placeholder="Enter your Gemini API key (starts with AIzaSy...)">
        <button onclick="testApiKey()">Test API Key</button>
        
        <div id="result" class="result"></div>
        
        <hr style="margin: 30px 0;">
        
        <h3>üìã How to Get API Key:</h3>
        <ol>
            <li>Go to <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a></li>
            <li>Sign in with your Google account</li>
            <li>Click "Create API Key"</li>
            <li>Copy the key (starts with AIzaSy...)</li>
            <li>Paste it above and test</li>
        </ol>
        
        <h3>üîç Troubleshooting:</h3>
        <ul>
            <li><strong>403 Error:</strong> API key is invalid or lacks permissions</li>
            <li><strong>429 Error:</strong> Rate limit exceeded, try again later</li>
            <li><strong>400 Error:</strong> API key format is incorrect</li>
        </ul>
    </div>

    <script>
        async function testApiKey() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const result = document.getElementById('result');
            
            if (!apiKey) {
                showResult('Please enter an API key', 'error');
                return;
            }
            
            if (!apiKey.startsWith('AIzaSy')) {
                showResult('API key should start with "AIzaSy"', 'error');
                return;
            }
            
            if (apiKey.length < 35) {
                showResult('API key seems too short. Please check the complete key.', 'error');
                return;
            }
            
            showResult('Testing API key...', 'success');
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: 'Hello! Please respond with: "API key is working perfectly!"'
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.1,
                            maxOutputTokens: 50
                        }
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                        const aiResponse = data.candidates[0].content.parts[0].text;
                        showResult(`‚úÖ SUCCESS! API key is valid and working.\n\nAI Response: "${aiResponse}"\n\nYou can now use this API key in the 7K Money app!`, 'success');
                    } else {
                        showResult('‚ö†Ô∏è API key works but response format is unexpected. It should still work in the app.', 'success');
                    }
                } else {
                    const errorData = await response.json().catch(() => ({}));
                    const errorMessage = errorData.error?.message || `HTTP ${response.status}: ${response.statusText}`;
                    
                    let userMessage = '';
                    if (response.status === 400) {
                        userMessage = '‚ùå INVALID API KEY FORMAT\nThe API key format is incorrect or the request is malformed.';
                    } else if (response.status === 403) {
                        userMessage = '‚ùå INVALID API KEY\nThe API key is invalid or doesn\'t have permission to use Gemini models.';
                    } else if (response.status === 429) {
                        userMessage = '‚è±Ô∏è RATE LIMIT EXCEEDED\nToo many requests. Please wait a few minutes and try again.';
                    } else {
                        userMessage = `‚ùå API ERROR\n${errorMessage}`;
                    }
                    
                    showResult(userMessage, 'error');
                }
            } catch (error) {
                showResult(`‚ùå NETWORK ERROR\n${error.message}\n\nCheck your internet connection and try again.`, 'error');
            }
        }
        
        function showResult(message, type) {
            const result = document.getElementById('result');
            result.className = `result ${type}`;
            result.style.display = 'block';
            result.innerHTML = message.replace(/\n/g, '<br>');
        }
    </script>
</body>
</html>